<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyHall OS 2.0</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        /* --- CSS VARIABLES & THEMES --- */
        :root {
            --bg-color: #f0f2f5;
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent: #3b82f6; /* Modern Blue */
            --accent-hover: #2563eb;
            --border: #e2e8f0;
            --success: #10b981;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 16px;
        }

        [data-theme="dark"] {
            --bg-color: #0f172a;
            --sidebar-bg: #1e293b;
            --card-bg: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent: #6366f1; /* Indigo */
            --accent-hover: #4f46e5;
            --border: #334155;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body { display: flex; height: 100vh; background-color: var(--bg-color); color: var(--text-primary); transition: background 0.3s; overflow: hidden; }

        /* --- UI COMPONENTS --- */
        .btn {
            padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer;
            font-weight: 600; transition: 0.2s; font-size: 0.9rem;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-hover); transform: translateY(-1px); }
        .btn-danger { background: #ef4444; color: white; }
        
        input, textarea, select {
            background: var(--bg-color); border: 1px solid var(--border);
            color: var(--text-primary); padding: 12px; border-radius: 8px;
            outline: none; transition: 0.2s; width: 100%;
        }
        input:focus, textarea:focus { border-color: var(--accent); }

        /* --- LOGIN OVERLAY --- */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 3000;
            display: flex; justify-content: center; align-items: center;
            backdrop-filter: blur(8px);
        }
        .login-box {
            background: var(--card-bg); padding: 40px; border-radius: 24px; 
            text-align: center; width: 400px; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 1px solid var(--border);
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 260px; background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 24px;
            transition: 0.3s; z-index: 100;
        }
        .logo { 
            font-size: 1.5rem; font-weight: 800; margin-bottom: 40px; 
            color: var(--accent); display: flex; align-items: center; gap: 10px;
        }
        .nav-btn {
            background: none; border: none; color: var(--text-secondary);
            padding: 12px 16px; text-align: left; cursor: pointer; border-radius: 12px;
            margin-bottom: 4px; font-size: 0.95rem; font-weight: 500;
            display: flex; align-items: center; gap: 12px; transition: 0.2s;
        }
        .nav-btn:hover { background: var(--bg-color); color: var(--text-primary); }
        .nav-btn.active { background: var(--accent); color: white; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); }

        /* --- MAIN CONTENT --- */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; position: relative; }
        .section { display: none; animation: fadeIn 0.4s ease-out; max-width: 1200px; margin: 0 auto; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { font-size: 2rem; margin-bottom: 20px; font-weight: 700; color: var(--text-primary); }
        
        .card {
            background: var(--card-bg); border-radius: var(--radius);
            padding: 24px; margin-bottom: 20px; box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        /* --- DASHBOARD WIDGETS --- */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        
        /* Pomodoro Timer */
        .timer-circle {
            width: 150px; height: 150px; border-radius: 50%;
            border: 6px solid var(--accent); display: flex;
            align-items: center; justify-content: center;
            font-size: 2.5rem; font-weight: bold; margin: 0 auto 20px auto;
            background: var(--bg-color);
        }

        /* --- STUDY TOOLS --- */
        /* To-Do */
        .todo-item {
            background: var(--bg-color); padding: 15px; margin-bottom: 8px;
            border-radius: 8px; display: flex; justify-content: space-between; align-items: center;
            border-left: 4px solid var(--accent); transition: 0.2s;
        }
        .todo-item.done { opacity: 0.6; text-decoration: line-through; border-left-color: var(--success); }
        
        /* Calculator */
        .calc-wrapper { display: flex; gap: 20px; flex-wrap: wrap; }
        .calc-body { width: 300px; }
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .calc-btn {
            padding: 15px; border-radius: 8px; font-size: 1.1rem;
            background: var(--bg-color); border: 1px solid var(--border);
            cursor: pointer; color: var(--text-primary);
        }
        .calc-btn:hover { background: var(--border); }
        .calc-btn.op { background: var(--accent); color: white; border: none; }
        
        /* Note Editor */
        .editor-container { position: relative; }
        textarea.notes-area {
            height: 500px; line-height: 1.6; font-size: 1.1rem;
            background: var(--card-bg); border: 1px solid var(--border);
            padding: 40px; resize: vertical;
            background-image: linear-gradient(var(--border) 1px, transparent 1px);
            background-size: 100% 2rem; /* Lined paper effect */
            background-attachment: local;
        }
        .word-count { position: absolute; bottom: 15px; right: 20px; font-size: 0.8rem; color: var(--text-secondary); }

        /* Periodic Table */
 </head>
<body>

    <h1>The Periodic Table</h1>
    <div class="periodic-table" id="table"></div>

    <div id="panel">
        <h2 id="p-sym">H</h2>
        <h3 id="p-name">Hydrogen</h3>
        <p id="p-data">Atomic #: 1<br>Mass: 1.008</p>
        <p id="p-cat" style="text-transform: capitalize; color: #888;">Reactive Nonmetal</p>
    </div>

<script>
    // This is the expanded data structure you were likely expecting.
    // Each element is a distinct object, making it easy to read and edit.
    
    const elements = [
        { num: 1, sym: "H", name: "Hydrogen", mass: "1.008", cat: "reactive-nonmetal", col: 1, row: 1 },
        { num: 2, sym: "He", name: "Helium", mass: "4.0026", cat: "noble-gas", col: 18, row: 1 },
        { num: 3, sym: "Li", name: "Lithium", mass: "6.94", cat: "alkali", col: 1, row: 2 },
        { num: 4, sym: "Be", name: "Beryllium", mass: "9.0122", cat: "alkaline", col: 2, row: 2 },
        { num: 5, sym: "B", name: "Boron", mass: "10.81", cat: "metalloid", col: 13, row: 2 },
        { num: 6, sym: "C", name: "Carbon", mass: "12.011", cat: "reactive-nonmetal", col: 14, row: 2 },
        { num: 7, sym: "N", name: "Nitrogen", mass: "14.007", cat: "reactive-nonmetal", col: 15, row: 2 },
        { num: 8, sym: "O", name: "Oxygen", mass: "15.999", cat: "reactive-nonmetal", col: 16, row: 2 },
        { num: 9, sym: "F", name: "Fluorine", mass: "18.998", cat: "reactive-nonmetal", col: 17, row: 2 },
        { num: 10, sym: "Ne", name: "Neon", mass: "20.180", cat: "noble-gas", col: 18, row: 2 },
        { num: 11, sym: "Na", name: "Sodium", mass: "22.990", cat: "alkali", col: 1, row: 3 },
        { num: 12, sym: "Mg", name: "Magnesium", mass: "24.305", cat: "alkaline", col: 2, row: 3 },
        { num: 13, sym: "Al", name: "Aluminum", mass: "26.982", cat: "post-transition", col: 13, row: 3 },
        { num: 14, sym: "Si", name: "Silicon", mass: "28.085", cat: "metalloid", col: 14, row: 3 },
        { num: 15, sym: "P", name: "Phosphorus", mass: "30.974", cat: "reactive-nonmetal", col: 15, row: 3 },
        { num: 16, sym: "S", name: "Sulfur", mass: "32.06", cat: "reactive-nonmetal", col: 16, row: 3 },
        { num: 17, sym: "Cl", name: "Chlorine", mass: "35.45", cat: "reactive-nonmetal", col: 17, row: 3 },
        { num: 18, sym: "Ar", name: "Argon", mass: "39.948", cat: "noble-gas", col: 18, row: 3 },
        { num: 19, sym: "K", name: "Potassium", mass: "39.098", cat: "alkali", col: 1, row: 4 },
        { num: 20, sym: "Ca", name: "Calcium", mass: "40.078", cat: "alkaline", col: 2, row: 4 },
        { num: 21, sym: "Sc", name: "Scandium", mass: "44.956", cat: "transition", col: 3, row: 4 },
        { num: 22, sym: "Ti", name: "Titanium", mass: "47.867", cat: "transition", col: 4, row: 4 },
        { num: 23, sym: "V", name: "Vanadium", mass: "50.942", cat: "transition", col: 5, row: 4 },
        { num: 24, sym: "Cr", name: "Chromium", mass: "51.996", cat: "transition", col: 6, row: 4 },
        { num: 25, sym: "Mn", name: "Manganese", mass: "54.938", cat: "transition", col: 7, row: 4 },
        { num: 26, sym: "Fe", name: "Iron", mass: "55.845", cat: "transition", col: 8, row: 4 },
        { num: 27, sym: "Co", name: "Cobalt", mass: "58.933", cat: "transition", col: 9, row: 4 },
        { num: 28, sym: "Ni", name: "Nickel", mass: "58.693", cat: "transition", col: 10, row: 4 },
        { num: 29, sym: "Cu", name: "Copper", mass: "63.546", cat: "transition", col: 11, row: 4 },
        { num: 30, sym: "Zn", name: "Zinc", mass: "65.38", cat: "transition", col: 12, row: 4 },
        { num: 31, sym: "Ga", name: "Gallium", mass: "69.723", cat: "post-transition", col: 13, row: 4 },
        { num: 32, sym: "Ge", name: "Germanium", mass: "72.630", cat: "metalloid", col: 14, row: 4 },
        { num: 33, sym: "As", name: "Arsenic", mass: "74.922", cat: "metalloid", col: 15, row: 4 },
        { num: 34, sym: "Se", name: "Selenium", mass: "78.971", cat: "reactive-nonmetal", col: 16, row: 4 },
        { num: 35, sym: "Br", name: "Bromine", mass: "79.904", cat: "reactive-nonmetal", col: 17, row: 4 },
        { num: 36, sym: "Kr", name: "Krypton", mass: "83.798", cat: "noble-gas", col: 18, row: 4 },
        { num: 37, sym: "Rb", name: "Rubidium", mass: "85.468", cat: "alkali", col: 1, row: 5 },
        { num: 38, sym: "Sr", name: "Strontium", mass: "87.62", cat: "alkaline", col: 2, row: 5 },
        { num: 39, sym: "Y", name: "Yttrium", mass: "88.906", cat: "transition", col: 3, row: 5 },
        { num: 40, sym: "Zr", name: "Zirconium", mass: "91.224", cat: "transition", col: 4, row: 5 },
        { num: 41, sym: "Nb", name: "Niobium", mass: "92.906", cat: "transition", col: 5, row: 5 },
        { num: 42, sym: "Mo", name: "Molybdenum", mass: "95.95", cat: "transition", col: 6, row: 5 },
        { num: 43, sym: "Tc", name: "Technetium", mass: "98", cat: "transition", col: 7, row: 5 },
        { num: 44, sym: "Ru", name: "Ruthenium", mass: "101.07", cat: "transition", col: 8, row: 5 },
        { num: 45, sym: "Rh", name: "Rhodium", mass: "102.91", cat: "transition", col: 9, row: 5 },
        { num: 46, sym: "Pd", name: "Palladium", mass: "106.42", cat: "transition", col: 10, row: 5 },
        { num: 47, sym: "Ag", name: "Silver", mass: "107.87", cat: "transition", col: 11, row: 5 },
        { num: 48, sym: "Cd", name: "Cadmium", mass: "112.41", cat: "transition", col: 12, row: 5 },
        { num: 49, sym: "In", name: "Indium", mass: "114.82", cat: "post-transition", col: 13, row: 5 },
        { num: 50, sym: "Sn", name: "Tin", mass: "118.71", cat: "post-transition", col: 14, row: 5 },
        { num: 51, sym: "Sb", name: "Antimony", mass: "121.76", cat: "metalloid", col: 15, row: 5 },
        { num: 52, sym: "Te", name: "Tellurium", mass: "127.60", cat: "metalloid", col: 16, row: 5 },
        { num: 53, sym: "I", name: "Iodine", mass: "126.90", cat: "reactive-nonmetal", col: 17, row: 5 },
        { num: 54, sym: "Xe", name: "Xenon", mass: "131.29", cat: "noble-gas", col: 18, row: 5 },
        { num: 55, sym: "Cs", name: "Cesium", mass: "132.91", cat: "alkali", col: 1, row: 6 },
        { num: 56, sym: "Ba", name: "Barium", mass: "137.33", cat: "alkaline", col: 2, row: 6 },
        // Lanthanides (Row 9)
        { num: 57, sym: "La", name: "Lanthanum", mass: "138.91", cat: "lanthanide", col: 4, row: 9 },
        { num: 58, sym: "Ce", name: "Cerium", mass: "140.12", cat: "lanthanide", col: 5, row: 9 },
        { num: 59, sym: "Pr", name: "Praseodymium", mass: "140.91", cat: "lanthanide", col: 6, row: 9 },
        { num: 60, sym: "Nd", name: "Neodymium", mass: "144.24", cat: "lanthanide", col: 7, row: 9 },
        { num: 61, sym: "Pm", name: "Promethium", mass: "145", cat: "lanthanide", col: 8, row: 9 },
        { num: 62, sym: "Sm", name: "Samarium", mass: "150.36", cat: "lanthanide", col: 9, row: 9 },
        { num: 63, sym: "Eu", name: "Europium", mass: "151.96", cat: "lanthanide", col: 10, row: 9 },
        { num: 64, sym: "Gd", name: "Gadolinium", mass: "157.25", cat: "lanthanide", col: 11, row: 9 },
        { num: 65, sym: "Tb", name: "Terbium", mass: "158.93", cat: "lanthanide", col: 12, row: 9 },
        { num: 66, sym: "Dy", name: "Dysprosium", mass: "162.50", cat: "lanthanide", col: 13, row: 9 },
        { num: 67, sym: "Ho", name: "Holmium", mass: "164.93", cat: "lanthanide", col: 14, row: 9 },
        { num: 68, sym: "Er", name: "Erbium", mass: "167.26", cat: "lanthanide", col: 15, row: 9 },
        { num: 69, sym: "Tm", name: "Thulium", mass: "168.93", cat: "lanthanide", col: 16, row: 9 },
        { num: 70, sym: "Yb", name: "Ytterbium", mass: "173.05", cat: "lanthanide", col: 17, row: 9 },
        { num: 71, sym: "Lu", name: "Lutetium", mass: "174.97", cat: "lanthanide", col: 18, row: 9 },
        // Back to Main Table Row 6
        { num: 72, sym: "Hf", name: "Hafnium", mass: "178.49", cat: "transition", col: 4, row: 6 },
        { num: 73, sym: "Ta", name: "Tantalum", mass: "180.95", cat: "transition", col: 5, row: 6 },
        { num: 74, sym: "W", name: "Tungsten", mass: "183.84", cat: "transition", col: 6, row: 6 },
        { num: 75, sym: "Re", name: "Rhenium", mass: "186.21", cat: "transition", col: 7, row: 6 },
        { num: 76, sym: "Os", name: "Osmium", mass: "190.23", cat: "transition", col: 8, row: 6 },
        { num: 77, sym: "Ir", name: "Iridium", mass: "192.22", cat: "transition", col: 9, row: 6 },
        { num: 78, sym: "Pt", name: "Platinum", mass: "195.08", cat: "transition", col: 10, row: 6 },
        { num: 79, sym: "Au", name: "Gold", mass: "196.97", cat: "transition", col: 11, row: 6 },
        { num: 80, sym: "Hg", name: "Mercury", mass: "200.59", cat: "transition", col: 12, row: 6 },
        { num: 81, sym: "Tl", name: "Thallium", mass: "204.38", cat: "post-transition", col: 13, row: 6 },
        { num: 82, sym: "Pb", name: "Lead", mass: "207.2", cat: "post-transition", col: 14, row: 6 },
        { num: 83, sym: "Bi", name: "Bismuth", mass: "208.98", cat: "post-transition", col: 15, row: 6 },
        { num: 84, sym: "Po", name: "Polonium", mass: "209", cat: "post-transition", col: 16, row: 6 },
        { num: 85, sym: "At", name: "Astatine", mass: "210", cat: "metalloid", col: 17, row: 6 },
        { num: 86, sym: "Rn", name: "Radon", mass: "222", cat: "noble-gas", col: 18, row: 6 },
        { num: 87, sym: "Fr", name: "Francium", mass: "223", cat: "alkali", col: 1, row: 7 },
        { num: 88, sym: "Ra", name: "Radium", mass: "226", cat: "alkaline", col: 2, row: 7 },
        // Actinides (Row 10)
        { num: 89, sym: "Ac", name: "Actinium", mass: "227", cat: "actinide", col: 4, row: 10 },
        { num: 90, sym: "Th", name: "Thorium", mass: "232.04", cat: "actinide", col: 5, row: 10 },
        { num: 91, sym: "Pa", name: "Protactinium", mass: "231.04", cat: "actinide", col: 6, row: 10 },
        { num: 92, sym: "U", name: "Uranium", mass: "238.03", cat: "actinide", col: 7, row: 10 },
        { num: 93, sym: "Np", name: "Neptunium", mass: "237", cat: "actinide", col: 8, row: 10 },
        { num: 94, sym: "Pu", name: "Plutonium", mass: "244", cat: "actinide", col: 9, row: 10 },
        { num: 95, sym: "Am", name: "Americium", mass: "243", cat: "actinide", col: 10, row: 10 },
        { num: 96, sym: "Cm", name: "Curium", mass: "247", cat: "actinide", col: 11, row: 10 },
        { num: 97, sym: "Bk", name: "Berkelium", mass: "247", cat: "actinide", col: 12, row: 10 },
        { num: 98, sym: "Cf", name: "Californium", mass: "251", cat: "actinide", col: 13, row: 10 },
        { num: 99, sym: "Es", name: "Einsteinium", mass: "252", cat: "actinide", col: 14, row: 10 },
        { num: 100, sym: "Fm", name: "Fermium", mass: "257", cat: "actinide", col: 15, row: 10 },
        { num: 101, sym: "Md", name: "Mendelevium", mass: "258", cat: "actinide", col: 16, row: 10 },
        { num: 102, sym: "No", name: "Nobelium", mass: "259", cat: "actinide", col: 17, row: 10 },
        { num: 103, sym: "Lr", name: "Lawrencium", mass: "266", cat: "actinide", col: 18, row: 10 },
        // Back to Main Table Row 7
        { num: 104, sym: "Rf", name: "Rutherfordium", mass: "267", cat: "transition", col: 4, row: 7 },
        { num: 105, sym: "Db", name: "Dubnium", mass: "268", cat: "transition", col: 5, row: 7 },
        { num: 106, sym: "Sg", name: "Seaborgium", mass: "269", cat: "transition", col: 6, row: 7 },
        { num: 107, sym: "Bh", name: "Bohrium", mass: "270", cat: "transition", col: 7, row: 7 },
        { num: 108, sym: "Hs", name: "Hassium", mass: "277", cat: "transition", col: 8, row: 7 },
        { num: 109, sym: "Mt", name: "Meitnerium", mass: "278", cat: "unknown", col: 9, row: 7 },
        { num: 110, sym: "Ds", name: "Darmstadtium", mass: "281", cat: "unknown", col: 10, row: 7 },
        { num: 111, sym: "Rg", name: "Roentgenium", mass: "282", cat: "unknown", col: 11, row: 7 },
        { num: 112, sym: "Cn", name: "Copernicium", mass: "285", cat: "transition", col: 12, row: 7 },
        { num: 113, sym: "Nh", name: "Nihonium", mass: "286", cat: "unknown", col: 13, row: 7 },
        { num: 114, sym: "Fl", name: "Flerovium", mass: "289", cat: "unknown", col: 14, row: 7 },
        { num: 115, sym: "Mc", name: "Moscovium", mass: "290", cat: "unknown", col: 15, row: 7 },
        { num: 116, sym: "Lv", name: "Livermorium", mass: "293", cat: "unknown", col: 16, row: 7 },
        { num: 117, sym: "Ts", name: "Tennessine", mass: "294", cat: "unknown", col: 17, row: 7 },
        { num: 118, sym: "Og", name: "Oganesson", mass: "294", cat: "unknown", col: 18, row: 7 }
    ];

    const table = document.getElementById('table');
    const panel = document.getElementById('panel');

    // Render Function
    elements.forEach(el => {
        const div = document.createElement('div');
        div.className = `element cat-${el.cat}`;
        div.style.gridColumn = el.col;
        div.style.gridRow = el.row;

        div.innerHTML = `
            <div class="num">${el.num}</div>
            <div class="sym">${el.sym}</div>
            <div class="name">${el.name}</div>
        `;

        // Click Event to open details
        div.addEventListener('click', () => {
            panel.classList.add('active');
            document.getElementById('p-sym').innerText = el.sym;
            document.getElementById('p-name').innerText = el.name;
            document.getElementById('p-data').innerHTML = `Atomic #: ${el.num}<br>Mass: ${el.mass}`;
            document.getElementById('p-cat').innerText = el.cat.replace(/-/g, ' ');
            
            // Match color
            const color = getComputedStyle(div).color;
            document.getElementById('p-sym').style.color = color;
        });

        table.appendChild(div);
    });
		/* Fullscreen */
        .fullscreen-active {
            position: fixed !important; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 5000; padding: 0; background: black;
        }
        iframe { width: 100%; height: 600px; border: none; border-radius: 12px; background: white; }

        /* Notification */
        #toast {
            position: fixed; bottom: 30px; right: 30px;
            background: var(--text-primary); color: var(--bg-color);
            padding: 12px 24px; border-radius: 50px; opacity: 0; transition: 0.3s;
            font-weight: 600; box-shadow: 0 10px 20px rgba(0,0,0,0.2); pointer-events: none;
        }
    </style>
</head>
<body class="mode-school" data-theme="light">

    <div id="login-overlay">
        <div class="login-box">
            <h1 style="color: var(--accent); margin-bottom:10px;">StudyHall OS</h1>
            <p style="color: var(--text-secondary); margin-bottom:20px;">Access your workspace</p>
            <input type="email" id="email" placeholder="Email" style="margin-bottom:10px;">
            <input type="password" id="password" placeholder="Password" style="margin-bottom:20px;">
            <button class="btn btn-primary" onclick="loginUser()" style="width:100%;">Enter Dashboard</button>
            <p id="login-error" style="margin-top:15px; color:#ef4444; font-size:0.9rem;"></p>
        </div>
    </div>

    <div id="toast">Saved automatically</div>

    <nav class="sidebar">
        <div class="logo">üìò StudyHall</div>
        <div style="margin-bottom: 20px;">
            <div id="user-display" style="font-weight:bold; font-size:0.9rem;">Guest</div>
            <div style="font-size:0.8rem; color:var(--text-secondary);">Student Mode</div>
        </div>
        
        <button class="nav-btn school-only active" onclick="showSection('school-home')">üè† Dashboard</button>
        <button class="nav-btn school-only" onclick="showSection('todo')">‚úÖ Tasks</button>
        <button class="nav-btn school-only" onclick="showSection('math')">üìê Math Lab</button>
        <button class="nav-btn school-only" onclick="showSection('science')">üß¨ Science Lab</button>
        <button class="nav-btn school-only" onclick="showSection('ela')">‚úçÔ∏è ELA Writer</button>
        <button class="nav-btn school-only" onclick="showSection('history')">üìú History</button>

        <button class="nav-btn fun-only" onclick="showSection('fun-home')">üéÆ Secret Lounge</button>
        <button class="nav-btn fun-only" onclick="showSection('games')">üïπÔ∏è Arcade</button>
        <button class="nav-btn fun-only" onclick="showSection('chatterbox')">üí¨ ChatterBox</button>
        <button class="nav-btn fun-only" onclick="showSection('socials')">üåê Web Browser</button>

        <div style="margin-top:auto;">
            <button class="nav-btn" onclick="showSection('settings')">‚öôÔ∏è System</button>
            <button class="nav-btn" onclick="logoutUser()" style="color:#ef4444;">üö™ Logout</button>
        </div>
    </nav>

    <main class="main-content">
        
        <div id="school-home" class="section active">
            <header style="margin-bottom:30px;">
                <h1 id="greeting">Good Morning.</h1>
                <p style="color:var(--text-secondary);">Here is your study overview.</p>
            </header>

            <div class="dashboard-grid">
                <div class="card" style="text-align:center;">
                    <h3>Focus Timer</h3>
                    <p style="color:var(--text-secondary); margin-bottom:20px;">25 min work ‚Ä¢ 5 min break</p>
                    <div class="timer-circle" id="timer-display">25:00</div>
                    <button class="btn btn-primary" onclick="toggleTimer()">Start / Pause</button>
                    <button class="btn" onclick="resetTimer()">Reset</button>
                </div>
                
                <div class="card">
                    <h3>At a Glance</h3>
                    <ul id="mini-todo-list" style="list-style:none; margin-top:15px; padding-left:0;">
                        <li style="color:var(--text-secondary);">No pending tasks.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="todo" class="section">
            <div class="card">
                <h2>Assignment Tracker</h2>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="newTodo" placeholder="What needs to be done?">
                    <button class="btn btn-primary" onclick="addTodo()">Add Task</button>
                </div>
                <div id="todoList"></div>
            </div>
        </div>

        <div id="math" class="section">
            <h2>Mathematics Laboratory</h2>
            <div class="calc-wrapper">
                <div class="card calc-body">
                    <h3>Scientific Calc</h3>
                    <input type="text" id="calcDisplay" readonly style="margin-bottom:15px; text-align:right; font-size:1.5rem; font-family:monospace;">
                    <div class="calc-grid">
                        <button class="calc-btn" onclick="calc('sin(')">sin</button>
                        <button class="calc-btn" onclick="calc('cos(')">cos</button>
                        <button class="calc-btn" onclick="calc('tan(')">tan</button>
                        <button class="calc-btn" onclick="calc('C')" style="background:#fee2e2; color:#ef4444;">AC</button>
                        
                        <button class="calc-btn" onclick="calc('sqrt(')">‚àö</button>
                        <button class="calc-btn" onclick="calc('pow(')">^</button>
                        <button class="calc-btn" onclick="calc('(')">(</button>
                        <button class="calc-btn" onclick="calc(')')">)</button>

                        <button class="calc-btn" onclick="calc('7')">7</button>
                        <button class="calc-btn" onclick="calc('8')">8</button>
                        <button class="calc-btn" onclick="calc('9')">9</button>
                        <button class="calc-btn op" onclick="calc('/')">√∑</button>

                        <button class="calc-btn" onclick="calc('4')">4</button>
                        <button class="calc-btn" onclick="calc('5')">5</button>
                        <button class="calc-btn" onclick="calc('6')">6</button>
                        <button class="calc-btn op" onclick="calc('*')">√ó</button>

                        <button class="calc-btn" onclick="calc('1')">1</button>
                        <button class="calc-btn" onclick="calc('2')">2</button>
                        <button class="calc-btn" onclick="calc('3')">3</button>
                        <button class="calc-btn op" onclick="calc('-')">-</button>

                        <button class="calc-btn" onclick="calc('0')">0</button>
                        <button class="calc-btn" onclick="calc('.')">.</button>
                        <button class="calc-btn" onclick="calc('PI')">œÄ</button>
                        <button class="calc-btn op" onclick="calc('=')">=</button>
                    </div>
                </div>

                <div class="card" style="flex:1;">
                    <h3>Math Notes & Formulas</h3>
                    <div style="margin-bottom:10px; font-size:0.9rem; color:var(--text-secondary);">
                        Tip: Write your theorems here. Area of Circle = œÄr¬≤
                    </div>
                    <div class="editor-container">
                        <textarea id="note-math" class="notes-area" oninput="saveData('math')" placeholder="Enter formulas..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="science" class="section">
            <h2>Science Laboratory</h2>
            
            <div class="card">
                <h3>Unit Converter</h3>
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="number" id="conv-input" placeholder="Value">
                    <select id="conv-type">
                        <option value="c-f">Celsius to Fahrenheit</option>
                        <option value="f-c">Fahrenheit to Celsius</option>
                        <option value="kg-lbs">Kg to Lbs</option>
                        <option value="m-ft">Meters to Feet</option>
                    </select>
                    <button class="btn btn-primary" onclick="convertUnit()">Convert</button>
                    <div id="conv-result" style="font-weight:bold; margin-left:10px;"></div>
                </div>
            </div>
            <div class="card">
                <h3>Lab Report Notes</h3>
                <div class="editor-container">
                    <textarea id="note-science" class="notes-area" oninput="saveData('science')" placeholder="Hypothesis..."></textarea>
                </div>
            </div>
        </div>

        <div id="ela" class="section">
            <h2>Writing Studio</h2>
            <div class="card">
                <div class="editor-container">
                    <textarea id="note-ela" class="notes-area" oninput="saveData('ela'); countWords('note-ela', 'ela-count')" placeholder="Start your essay..."></textarea>
                    <div class="word-count" id="ela-count">0 words</div>
                </div>
            </div>
        </div>

        <div id="history" class="section">
            <h2>History Archives</h2>
            <div class="card">
                <div class="editor-container">
                    <textarea id="note-history" class="notes-area" oninput="saveData('history'); countWords('note-history', 'hist-count')" placeholder="Timeline of events..."></textarea>
                    <div class="word-count" id="hist-count">0 words</div>
                </div>
            </div>
        </div>

        <div id="fun-home" class="section">
            <h2>Secret Lounge</h2>
            <p>Welcome to the unlocked section. Keep it quiet.</p>
        </div>

        <div id="games" class="section">
            <h2>Arcade</h2>
            <div class="dashboard-grid">
                <div class="card">
                    <h3>Geometry Dash</h3>
                    <p style="color:var(--text-secondary);">Rhythm-based platformer.</p>
                    <button class="btn btn-primary" onclick="loadGeoDash()">Play Now</button>
                </div>
                <div class="card">
                    <h3>Drive Mad</h3>
                    <p style="color:var(--text-secondary);">Physics driving game.</p>
                    <button class="btn btn-primary" onclick="loadDriveMad()">Play Now</button>
                </div>
                <div class="card">
            <div class="card" style="padding:0; overflow:hidden;">
                <iframe id="game-frame" src=""></iframe>
            </div>
        </div>

        <div id="chatterbox" class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <h2>ChatterBox</h2>
                <button class="btn" onclick="toggleFullscreenChat()">‚õ∂ Fullscreen</button>
            </div>
            <iframe src="https://whatever-works123.github.io/Chatter-Box/"></iframe>
        </div>

        <div id="socials" class="section">
            <h2>Web Browser</h2>
            <iframe src="https://bing.com"></iframe>
        </div>

        <div id="settings" class="section">
            <h2>System Settings</h2>
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üîí Stealth Mode</h3>
                    <p>Toggle between School and Fun mode instantly.</p>
                    <button class="btn btn-primary" onclick="toggleMode()">Switch Mode</button>
                    <p style="font-size:0.8rem; margin-top:10px; color:var(--text-secondary);">Shortcut: Press <strong>ESC</strong> key.</p>
                </div>
                <div class="card">
                    <h3>üé® Appearance</h3>
                    <p>Switch between Light and Dark themes.</p>
                    <button class="btn" onclick="toggleTheme()">Toggle Theme</button>
                </div>
            </div>
        </div>
    </main>

    <textarea id="drive-mad-code" style="display:none;">
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<script src="https://cdn.jsdelivr.net/npm/p5@1.11.5/lib/p5.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/p5@1.11.5/lib/addons/p5.sound.min.js"></script>
	<script src="mySketch.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
<head>
  <base href="https://cdn.jsdelivr.net/gh/genizy/dmad-poki@49b5ab6b987f5f3be58f9dae59c92e8fc1aab9b0/">
  <script>
  window.assgdd = {
    "ancestorOrigins": { "0": "https://games.poki.com", "1": "https://poki.com" },
    "href": "https://f9564e4e-ef25-4e4b-ba67-cb11a1576bbd.poki-gdn.com/cc1bc57a-e355-4696-97c2-097bf6188606/index.html?cloudsavegames=y"
  }
  </script>
  <meta charset="utf-8"><title>Drive Mad</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="stylesheet" href="webapp/fancade.css">
  <script src="poki-sdk.js" ></script>
</head>
<body id="body">
  <div id="canvas_border" class="emscripten_border">
    <div id="play_content" class="middle center">
      <div class="edge"><div class="box"><div class="black"><img src="webapp/cover.jpg" class="cover"><p class="title">Drive Mad</p></div></div></div>
      <div id="progress_or_play"><progress id="progress" class="loading" value="0" max="100"></progress></div>
    </div>
    <canvas class="emscripten" id="canvas" tabindex=-1></canvas>
  </div>
  <script type="text/javascript" src="webapp/source_min.js"></script>
  <script type="text/javascript" src="webapp/index.js"></script>
</body>
</html>
    </textarea>

    <textarea id="snake-code" style="display:none;">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>Snake</title>
    <style>body{display:flex;justify-content:center;align-items:center;height:100vh;margin:0;background:#333;color:white;font-family:monospace;}canvas{background:#000;border:2px solid #fff;}.score-board{margin-bottom:10px;font-size:1.5em;}</style>
</head>
<body>
    <div class="score-board">Score: <span id="score">0</span></div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <script>
        const canvas=document.getElementById('gameCanvas'),ctx=canvas.getContext('2d'),scoreElement=document.getElementById('score');
        const gridSize=20;let snake=[{x:200,y:200}],food={},dx=gridSize,dy=0,score=0;
        function main(){setTimeout(()=>{clear();drawFood();move();drawSnake();if(checkOver()){alert("Game Over: "+score);location.reload()}else main()},100)}
        function clear(){ctx.fillStyle='#000';ctx.fillRect(0,0,400,400)}
        function drawSnake(){snake.forEach(p=>{ctx.fillStyle='#4CAF50';ctx.fillRect(p.x,p.y,gridSize,gridSize);ctx.strokeRect(p.x,p.y,gridSize,gridSize)})}
        function move(){const head={x:snake[0].x+dx,y:snake[0].y+dy};snake.unshift(head);if(head.x===food.x&&head.y===food.y){score+=10;scoreElement.innerText=score;placeFood()}else snake.pop()}
        function placeFood(){food.x=Math.floor(Math.random()*20)*20;food.y=Math.floor(Math.random()*20)*20}
        function checkOver(){return snake[0].x<0||snake[0].x>=400||snake[0].y<0||snake[0].y>=400||snake.slice(1).some(p=>p.x===snake[0].x&&p.y===snake[0].y)}
        document.addEventListener('keydown',e=>{
            if(e.which===37&&dx===0){dx=-20;dy=0}if(e.which===38&&dy===0){dx=0;dy=-20}
            if(e.which===39&&dx===0){dx=20;dy=0}if(e.which===40&&dy===0){dx=0;dy=20}
        });
        placeFood();main();
    </script>
</body>
</html>
    </textarea>

    <textarea id="geo-dash-code" style="display:none;">
<!DOCTYPE html>
<html lang="en-US">
<head>
    <base href="https://rawcdn.githack.com/genizy/google-class/main/gdlite/">
    <title>Geometry Dash</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="themes/geometrydashlite.io/rs/css/home.css?v=1">
</head>
<body style="margin:0;overflow:hidden;background:#000;">
    <div id="gameContainer" style="width:100vw;height:100vh;"></div>
    <script src="Build/UnityLoader.js"></script>
    <script>
        var gameInstance = UnityLoader.instantiate("gameContainer", "Build/GeometryDashLite.json");
    </script>
</body>
</html>
    </textarea>

    <script>
        // --- CONFIG & AUTH ---
        const firebaseConfig = {
            apiKey: "AIzaSyABujQAAYKhMxJddtJSvTShWEZ8bqF3kzA",
            authDomain: "chatterbox3000-fb3e2.firebaseapp.com",
            databaseURL: "https://chatterbox3000-fb3e2-default-rtdb.firebaseio.com",
            projectId: "chatterbox3000-fb3e2",
            storageBucket: "chatterbox3000-fb3e2.firebasestorage.app",
            messagingSenderId: "298622361038",
            appId: "1:298622361038:web:c1e46432470dbce92a5f9f"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let currentUser = null;
        let todoArray = [];

        // Greeting
        const hour = new Date().getHours();
        document.getElementById('greeting').innerText = hour < 12 ? 'Good Morning.' : hour < 18 ? 'Good Afternoon.' : 'Good Evening.';

        // Auth Listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('user-display').innerText = user.email.split('@')[0];
                loadUserData(); 
            } else {
                document.getElementById('login-overlay').style.display = 'flex';
                currentUser = null;
            }
        });

        function loginUser() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const err = document.getElementById('login-error');
            err.innerText = "Authenticating...";
            auth.signInWithEmailAndPassword(email, pass).catch(e => err.innerText = e.message);
        }
        function logoutUser() { auth.signOut(); location.reload(); }

        // --- DATABASE ---
        function toast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg || "Saved automatically";
            t.style.opacity = '1';
            setTimeout(() => t.style.opacity = '0', 2000);
        }

        function loadUserData() {
            if(!currentUser) return;
            db.ref('users/' + currentUser.uid).once('value').then(snap => {
                const data = snap.val();
                if (data) {
                    ['math', 'science', 'ela', 'history'].forEach(sub => {
                        if(data[sub]) {
                            document.getElementById('note-' + sub).value = data[sub];
                            if(sub === 'ela' || sub === 'history') countWords('note-'+sub, sub==='ela'?'ela-count':'hist-count');
                        }
                    });
                    if(data.todos) { todoArray = data.todos; renderTodos(); }
                }
            });
        }

        function saveData(subject) {
            if(!currentUser) return;
            db.ref('users/' + currentUser.uid + '/' + subject).set(document.getElementById('note-' + subject).value)
                .then(() => toast());
        }

        // --- STUDY TOOLS ---
        // To-Do
        function addTodo() {
            const txt = document.getElementById('newTodo').value;
            if(!txt) return;
            todoArray.push({text: txt, done: false});
            updateTodoDB();
            document.getElementById('newTodo').value = '';
        }
        function toggleTodo(idx) {
            todoArray[idx].done = !todoArray[idx].done;
            updateTodoDB();
        }
        function removeTodo(idx) {
            todoArray.splice(idx, 1);
            updateTodoDB();
        }
        function updateTodoDB() {
            if(currentUser) db.ref('users/' + currentUser.uid + '/todos').set(todoArray).then(() => toast("Task updated"));
            renderTodos();
        }
        function renderTodos() {
            const list = document.getElementById('todoList');
            const mini = document.getElementById('mini-todo-list');
            list.innerHTML = '';
            mini.innerHTML = '';
            
            let pendingCount = 0;

            todoArray.forEach((task, i) => {
                // Main List
                list.innerHTML += `
                    <div class="todo-item ${task.done ? 'done' : ''}">
                        <span onclick="toggleTodo(${i})" style="cursor:pointer; flex:1;">${task.text}</span>
                        <button class="btn btn-danger" onclick="removeTodo(${i})" style="padding:5px 10px;">√ó</button>
                    </div>`;
                
                // Dashboard Mini List (only show first 3 pending)
                if(!task.done) {
                    pendingCount++;
                    if(pendingCount <= 3) {
                        mini.innerHTML += `<li style="margin-bottom:5px;">‚Ä¢ ${task.text}</li>`;
                    }
                }
            });

            if(pendingCount === 0) mini.innerHTML = '<li style="color:var(--text-secondary);">No pending tasks.</li>';
        }

        // Calculator
        function calc(val) {
            const disp = document.getElementById('calcDisplay');
            if(val === 'C') disp.value = '';
            else if(val === '=') {
                try {
                    let expr = disp.value
                        .replace(/sin/g, 'Math.sin')
                        .replace(/cos/g, 'Math.cos')
                        .replace(/tan/g, 'Math.tan')
                        .replace(/sqrt/g, 'Math.sqrt')
                        .replace(/pow/g, 'Math.pow')
                        .replace(/PI/g, 'Math.PI');
                    disp.value = eval(expr);
                } catch { disp.value = 'Error'; }
            } else { disp.value += val; }
        }

        // Science Converter
        function convertUnit() {
            const val = parseFloat(document.getElementById('conv-input').value);
            const type = document.getElementById('conv-type').value;
            let res = 0;
            if(isNaN(val)) return;

            if(type === 'c-f') res = (val * 9/5) + 32 + ' ¬∞F';
            else if(type === 'f-c') res = (val - 32) * 5/9 + ' ¬∞C';
            else if(type === 'kg-lbs') res = val * 2.20462 + ' lbs';
            else if(type === 'm-ft') res = val * 3.28084 + ' ft';
            
            document.getElementById('conv-result').innerText = res;
        }

        // Pomodoro Timer
        let timerInt = null;
        let timeLeft = 25 * 60;
        function toggleTimer() {
            if(timerInt) { clearInterval(timerInt); timerInt = null; }
            else {
                timerInt = setInterval(() => {
                    if(timeLeft > 0) {
                        timeLeft--;
                        let m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
                        let s = (timeLeft % 60).toString().padStart(2, '0');
                        document.getElementById('timer-display').innerText = `${m}:${s}`;
                    } else {
                        clearInterval(timerInt);
                        alert("Time's up! Take a break.");
                    }
                }, 1000);
            }
        }
        function resetTimer() {
            clearInterval(timerInt); timerInt = null;
            timeLeft = 25 * 60;
            document.getElementById('timer-display').innerText = "25:00";
        }

        // Word Count
        function countWords(areaId, displayId) {
            const txt = document.getElementById(areaId).value.trim();
            const count = txt ? txt.split(/\s+/).length : 0;
            document.getElementById(displayId).innerText = count + " words";
        }

        // --- NAVIGATION ---
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const btn = Array.from(document.querySelectorAll('.nav-btn')).find(b => b.getAttribute('onclick').includes(id));
            if(btn) btn.classList.add('active');
        }

        function toggleMode() {
            document.body.classList.toggle('mode-school');
            document.body.classList.toggle('mode-fun');
            showSection(document.body.classList.contains('mode-school') ? 'school-home' : 'fun-home');
        }

        function toggleTheme() {
            const b = document.body;
            b.setAttribute('data-theme', b.getAttribute('data-theme') === 'light' ? 'dark' : 'light');
        }

        // Games Loading
        function loadGame(codeId) {
            const iframe = document.getElementById('game-frame');
            iframe.srcdoc = document.getElementById(codeId).value;
            iframe.onload = () => iframe.contentWindow.focus();
        }
        function loadDriveMad() { loadGame('drive-mad-code'); }
        function loadSnakeGame() { loadGame('snake-code'); }
        function loadGeoDash() { loadGame('geo-dash-code'); }

        function toggleFullscreenChat() {
            document.getElementById('chatterbox').classList.toggle('fullscreen-active');
        }

        document.addEventListener('keydown', e => {
            if(e.key === "Escape") {
                const c = document.getElementById('chatterbox');
                if(c.classList.contains('fullscreen-active')) c.classList.remove('fullscreen-active');
                if(document.body.classList.contains('mode-fun')) toggleMode();
            }
        });
    </script>
</body>
</html>
