<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyHall OS 5.0 (Schedule Edition)</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --bg-color: #f1f5f9;
            --sidebar-bg: rgba(255, 255, 255, 0.95);
            --card-bg: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --accent: #2563eb;
            --accent-hover: #1d4ed8;
            --border: #e2e8f0;
            --success: #10b981;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            --radius: 16px;
            
            /* Periodic Table Colors */
            --cat-1: #ef4444; --cat-2: #f97316; --cat-3: #eab308; 
            --cat-4: #22c55e; --cat-5: #06b6d4; --cat-6: #3b82f6; 
            --cat-7: #8b5cf6; --cat-8: #d946ef; --cat-9: #f43f5e; --cat-0: #94a3b8;
        }

        [data-theme="dark"] {
            --bg-color: #000000;
            --sidebar-bg: #121212;
            --card-bg: #121212;
            --text-primary: #f8fafc;
            --text-secondary: #a8a29e;
            --accent: #6366f1;
            --border: #262626;
            --shadow: none;
        }

        body.mode-school .fun-only { display: none !important; }
        body.mode-fun .school-only { display: none !important; }
        
        body.mode-fun {
            --bg-color: #000000;
            --sidebar-bg: #000000;
            --card-bg: #121212;
            --text-primary: #f5f5f5;
            --text-secondary: #a3a3a3;
            --accent: #a855f7;
            --border: #333333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { display: flex; height: 100vh; background-color: var(--bg-color); color: var(--text-primary); transition: background 0.3s; overflow: hidden; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

        /* --- UI COMPONENTS --- */
        .btn { padding: 10px 18px; border-radius: 8px; border: none; cursor: pointer; font-weight: 600; transition: 0.2s; font-size: 0.9rem; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn-danger { background: #ef4444; color: white; }
        
        input, textarea, select {
            background: var(--bg-color); border: 1px solid var(--border);
            color: var(--text-primary); padding: 12px; border-radius: 8px;
            outline: none; transition: 0.2s; width: 100%; font-size: 0.95rem;
        }
        input:focus, textarea:focus { border-color: var(--accent); }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 250px; background-color: var(--sidebar-bg); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 24px; transition: 0.3s; z-index: 100;
        }
        .logo { font-size: 1.5rem; font-weight: 800; margin-bottom: 35px; color: var(--accent); display: flex; align-items: center; gap: 10px; }
        .nav-btn {
            background: none; border: none; color: var(--text-secondary);
            padding: 12px 14px; text-align: left; cursor: pointer; border-radius: 10px;
            margin-bottom: 4px; font-size: 0.95rem; font-weight: 500; display: flex; align-items: center; gap: 12px; transition: 0.2s;
        }
        .nav-btn:hover { background: var(--bg-color); color: var(--text-primary); }
        .nav-btn.active { background: var(--accent); color: white; font-weight: 600; }

        /* --- MAIN CONTENT --- */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; position: relative; }
        .section { display: none; animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); max-width: 1100px; margin: 0 auto; }
        .section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .card {
            background: var(--card-bg); border-radius: var(--radius);
            padding: 24px; margin-bottom: 20px; box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        /* --- DASHBOARD WIDGETS --- */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .timer-circle {
            width: 140px; height: 140px; border-radius: 50%;
            border: 6px solid var(--border); border-top-color: var(--accent);
            display: flex; align-items: center; justify-content: center;
            font-size: 2.2rem; font-weight: 700; margin: 0 auto 20px auto;
            background: var(--bg-color); color: var(--text-primary);
        }
        .todo-item { background: var(--bg-color); padding: 14px; margin-bottom: 8px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--accent); }
        .todo-item.done { opacity: 0.6; text-decoration: line-through; border-left-color: var(--success); }

        /* --- MATH & EDITOR --- */
        .calc-wrapper { display: flex; gap: 20px; flex-wrap: wrap; }
        .calc-body { width: 280px; }
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .calc-btn { padding: 15px; border-radius: 8px; font-size: 1.1rem; background: var(--bg-color); border: 1px solid var(--border); cursor: pointer; color: var(--text-primary); }
        textarea.notes-area { height: 500px; line-height: 1.6; font-size: 1.05rem; background: var(--card-bg); border: 1px solid var(--border); padding: 30px; resize: vertical; }

        /* --- PERIODIC TABLE --- */
        .periodic-table { display: grid; grid-template-columns: repeat(18, 1fr); gap: 3px; width: 100%; max-width: 900px; margin: 0 auto; }
        .element { background: var(--bg-color); border: 1px solid var(--border); color: var(--text-primary); aspect-ratio: 5/6; padding: 4px; border-radius: 4px; cursor: pointer; display: flex; flex-direction: column; justify-content: space-between; }
        .element:hover { transform: scale(1.6); z-index: 100; background: var(--card-bg); border-color: var(--accent); box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .num { font-size: 8px; opacity: 0.6; } .sym { font-size: 14px; font-weight: 700; text-align: center; }
        .cat-alkali { border-bottom: 3px solid var(--cat-1); } .cat-alkaline { border-bottom: 3px solid var(--cat-2); }
        .cat-transition { border-bottom: 3px solid var(--cat-3); } .cat-post-transition { border-bottom: 3px solid var(--cat-4); }
        .cat-metalloid { border-bottom: 3px solid var(--cat-5); } .cat-reactive-nonmetal { border-bottom: 3px solid var(--cat-6); }
        .cat-noble-gas { border-bottom: 3px solid var(--cat-7); } .cat-lanthanide { border-bottom: 3px solid var(--cat-8); }
        .cat-actinide { border-bottom: 3px solid var(--cat-9); } .cat-unknown { border-bottom: 3px solid var(--cat-0); }
        #pt-panel { background: var(--bg-color); border: 1px solid var(--border); padding: 15px 25px; border-radius: 12px; margin-bottom: 20px; display: none; align-items: center; justify-content: space-between; }
        #pt-panel.active { display: flex; animation: fadeIn 0.2s; }

        /* --- INSTAGRAM CLONE STYLES --- */
        .insta-main-wrapper { max-width: 600px; margin: 0 auto; }
        .insta-navbar { background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 20px; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; }
        .insta-nav-icons { display: flex; align-items: center; gap: 15px; }
        .insta-nav-icons i { font-size: 1.4rem; color: var(--text-primary); cursor: pointer; transition: transform 0.2s; }
        .insta-nav-icons i:hover { transform: scale(1.1); }
        .insta-post-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 20px; overflow: hidden; }
        .insta-post-header { padding: 12px; display: flex; align-items: center; justify-content: space-between; }
        .insta-user-details { display: flex; align-items: center; gap: 10px; }
        .insta-profile-pic { width: 32px; height: 32px; border-radius: 50%; padding: 1.5px; background: linear-gradient(45deg, #f09433, #bc1888); }
        .insta-profile-pic div, .insta-profile-pic img { width: 100%; height: 100%; border-radius: 50%; border: 1.5px solid var(--card-bg); object-fit: cover; }
        .insta-user-details h3 { font-size: 0.9rem; font-weight: 600; margin: 0; color: var(--text-primary); }
        .insta-user-details span { font-size: 0.75rem; color: var(--text-secondary); }
        .insta-post-img { width: 100%; display: block; background: #000; min-height: 200px; object-fit: cover; }
        .insta-post-footer { padding: 12px; }
        .insta-actions { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .insta-action-left { display: flex; gap: 15px; }
        .insta-actions i { font-size: 1.5rem; color: var(--text-primary); cursor: pointer; transition: 0.2s; }
        .insta-actions i:hover { color: var(--accent); }
        .fa-heart.liked { color: #ed4956; animation: pop 0.3s ease; }
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
        .insta-likes { font-weight: 600; font-size: 0.9rem; margin-bottom: 6px; }
        .insta-caption { font-size: 0.9rem; line-height: 1.4; margin-bottom: 6px; }
        .insta-caption b { font-weight: 600; margin-right: 5px; }
        .insta-time { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 5px; }

        /* --- FULLSCREEN UTILS --- */
        .fullscreen-mode {
            position: fixed !important; top: 0; left: 0; width: 100vw; height: 100vh;
            background: black; z-index: 99999; padding: 0; margin: 0;
            display: flex; flex-direction: column; border-radius: 0 !important;
        }
        .fullscreen-mode iframe { width: 100%; height: 100%; border: none; border-radius: 0; }
        iframe { width: 100%; height: 600px; border: none; border-radius: 12px; background: white; }
        
        /* --- OVERLAYS (Login & Setup) --- */
        #login-overlay, #setup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(8px); }
        .login-box { background: var(--card-bg); padding: 40px; border-radius: 24px; text-align: center; width: 380px; box-shadow: 0 25px 50px rgba(0,0,0,0.2); border: 1px solid var(--border); }
        #toast { position: fixed; bottom: 30px; right: 30px; background: var(--text-primary); color: var(--bg-color); padding: 12px 24px; border-radius: 50px; opacity: 0; transition: 0.3s; font-weight: 600; box-shadow: 0 10px 20px rgba(0,0,0,0.15); pointer-events: none; z-index: 9999; }
        
        /* --- SCHEDULE STYLES --- */
        .schedule-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; text-align: left; }
        .schedule-col h4 { margin-bottom: 10px; color: var(--text-secondary); border-bottom: 2px solid; padding-bottom: 5px; display: inline-block; }
        .red-day h4 { border-color: #ef4444; color: #ef4444; }
        .green-day h4 { border-color: #10b981; color: #10b981; }
        .class-input { margin-bottom: 8px; font-size: 0.9rem; }
        .schedule-display-list { list-style: none; padding: 0; }
        .schedule-display-list li { padding: 8px; border-bottom: 1px solid var(--border); font-size: 0.9rem; display: flex; justify-content: space-between; }
        .schedule-display-list li span { font-weight: 700; color: var(--text-secondary); width: 40px; }
    </style>
</head>
<body class="mode-school" data-theme="light">

    <div id="login-overlay">
        <div class="login-box">
            <h1 style="color: var(--accent); margin-bottom:10px;">StudyHall OS</h1>
            <p style="color: var(--text-secondary); margin-bottom:25px;">Enter your workspace</p>
            <input type="email" id="email" placeholder="Email" style="margin-bottom:10px;">
            <input type="password" id="password" placeholder="Password" style="margin-bottom:20px;">
            <button class="btn btn-primary" onclick="loginUser()" style="width:100%;">Enter Dashboard</button>
            <p id="login-error" style="margin-top:15px; color:#ef4444; font-size:0.9rem;"></p>
        </div>
    </div>

    <div id="setup-overlay" style="display:none;">
        <div class="login-box" style="width: 500px; text-align: left;">
            <h2 style="color: var(--accent); margin-bottom:10px; text-align:center;">Setup Schedule</h2>
            <p style="color: var(--text-secondary); margin-bottom:20px; text-align:center;">Please enter your classes for the block schedule.</p>
            
            <div class="schedule-grid">
                <div class="schedule-col red-day">
                    <h4>üü• Red Day</h4>
                    <input class="class-input" id="setup-r1" placeholder="R1 Class Name">
                    <input class="class-input" id="setup-r2" placeholder="R2 Class Name">
                    <input class="class-input" id="setup-r3" placeholder="R3 Class Name">
                    <input class="class-input" id="setup-r4" placeholder="R4 Class Name">
                </div>
                <div class="schedule-col green-day">
                    <h4>üü© Green Day</h4>
                    <input class="class-input" id="setup-g5" placeholder="G5 Class Name">
                    <input class="class-input" id="setup-g6" placeholder="G6 Class Name">
                    <input class="class-input" id="setup-g7" placeholder="G7 Class Name">
                    <input class="class-input" id="setup-g8" placeholder="G8 Class Name">
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="saveInitialSetup()" style="width:100%;">Save & Enter OS</button>
        </div>
    </div>

    <div id="toast">Saved automatically</div>

    <nav class="sidebar">
        <div class="logo">üìò StudyHall</div>
        <div style="margin-bottom: 25px; padding: 15px; background: var(--bg-color); border-radius: 12px;">
            <div id="user-display" style="font-weight:700; font-size:0.95rem;">Guest</div>
            <div style="font-size:0.8rem; color:var(--text-secondary); margin-top:2px;">Student Mode</div>
        </div>
        
        <button class="nav-btn school-only active" onclick="showSection('school-home')">üè† Dashboard</button>
        <button class="nav-btn school-only" onclick="showSection('todo')">‚úÖ Tasks</button>
        <button class="nav-btn school-only" onclick="showSection('math')">üìê Math Lab</button>
        <button class="nav-btn school-only" onclick="showSection('science')">üß¨ Science Lab</button>
        <button class="nav-btn school-only" onclick="showSection('ela')">‚úçÔ∏è ELA Writer</button>
        <button class="nav-btn school-only" onclick="showSection('history')">üìú History</button>

        <button class="nav-btn fun-only" onclick="showSection('fun-home')">üéÆ Secret Lounge</button>
        <button class="nav-btn fun-only" onclick="showSection('games')">üïπÔ∏è Arcade</button>
        <button class="nav-btn fun-only" onclick="showSection('social-feed')">üì∏ Social Feed</button>
        <button class="nav-btn fun-only" onclick="showSection('chatterbox')">üí¨ ChatterBox</button>

        <div style="margin-top:auto;">
            <button class="nav-btn" onclick="showSection('settings')">‚öôÔ∏è Settings</button>
            <button class="nav-btn" onclick="logoutUser()" style="color:#ef4444;">üö™ Logout</button>
        </div>
    </nav>

    <main class="main-content">
        
        <div id="school-home" class="section active">
            <header style="margin-bottom:35px;">
                <h1 id="greeting">Welcome Back.</h1>
                <p style="color:var(--text-secondary);">Your academic dashboard is ready.</p>
            </header>
            <div class="dashboard-grid">
                
                <div class="card">
                    <h3>üìÖ My Schedule</h3>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:15px;">
                        <div>
                            <h4 style="color:#ef4444; margin-bottom:10px;">Red Day</h4>
                            <ul class="schedule-display-list" id="dash-red-list">
                                <li><span>R1</span> ...</li>
                                <li><span>R2</span> ...</li>
                                <li><span>R3</span> ...</li>
                                <li><span>R4</span> ...</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color:#10b981; margin-bottom:10px;">Green Day</h4>
                            <ul class="schedule-display-list" id="dash-green-list">
                                <li><span>G5</span> ...</li>
                                <li><span>G6</span> ...</li>
                                <li><span>G7</span> ...</li>
                                <li><span>G8</span> ...</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card" style="text-align:center;">
                    <h3>Focus Timer</h3>
                    <div class="timer-circle" id="timer-ui"><span id="timer-display">25:00</span></div>
                    <div style="margin-top:20px;">
                        <button class="btn btn-primary" onclick="toggleTimer()">Start / Pause</button>
                        <button class="btn" onclick="resetTimer()">Reset</button>
                    </div>
                </div>
                <div class="card">
                    <h3>At a Glance</h3>
                    <ul id="mini-todo-list" style="list-style:none; margin-top:15px; padding-left:0;">
                        <li style="color:var(--text-secondary);">No pending tasks.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="todo" class="section">
            <div class="card">
                <h2>Assignment Tracker</h2>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="newTodo" placeholder="Add a new task...">
                    <button class="btn btn-primary" onclick="addTodo()">Add</button>
                </div>
                <div id="todoList"></div>
            </div>
        </div>

        <div id="math" class="section">
            <h2>Mathematics Laboratory</h2>
            <div class="calc-wrapper">
                <div class="card calc-body">
                    <input type="text" id="calcDisplay" readonly style="margin-bottom:15px; text-align:right; font-size:1.5rem; font-family:monospace; font-weight:600;">
                    <div class="calc-grid">
                        <button class="calc-btn" onclick="calc('sin(')">sin</button>
                        <button class="calc-btn" onclick="calc('cos(')">cos</button>
                        <button class="calc-btn" onclick="calc('tan(')">tan</button>
                        <button class="calc-btn" onclick="calc('C')" style="background:#fee2e2; color:#ef4444;">AC</button>
                        <button class="calc-btn" onclick="calc('sqrt(')">‚àö</button>
                        <button class="calc-btn" onclick="calc('pow(')">^</button>
                        <button class="calc-btn" onclick="calc('(')">(</button>
                        <button class="calc-btn" onclick="calc(')')">)</button>
                        <button class="calc-btn" onclick="calc('7')">7</button>
                        <button class="calc-btn" onclick="calc('8')">8</button>
                        <button class="calc-btn" onclick="calc('9')">9</button>
                        <button class="calc-btn op" onclick="calc('/')">√∑</button>
                        <button class="calc-btn" onclick="calc('4')">4</button>
                        <button class="calc-btn" onclick="calc('5')">5</button>
                        <button class="calc-btn" onclick="calc('6')">6</button>
                        <button class="calc-btn op" onclick="calc('*')">√ó</button>
                        <button class="calc-btn" onclick="calc('1')">1</button>
                        <button class="calc-btn" onclick="calc('2')">2</button>
                        <button class="calc-btn" onclick="calc('3')">3</button>
                        <button class="calc-btn op" onclick="calc('-')">-</button>
                        <button class="calc-btn" onclick="calc('0')">0</button>
                        <button class="calc-btn" onclick="calc('.')">.</button>
                        <button class="calc-btn" onclick="calc('PI')">œÄ</button>
                        <button class="calc-btn op" onclick="calc('=')">=</button>
                    </div>
                </div>
                <div class="card" style="flex:1;">
                    <h3>Notes & Formulas</h3>
                    <textarea id="note-math" class="notes-area" oninput="saveData('math')" placeholder="Write your formulas here..."></textarea>
                </div>
            </div>
        </div>

        <div id="science" class="section">
            <h2>Science Laboratory</h2>
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3>Periodic Table</h3>
                    <span style="font-size:0.8rem; color:var(--text-secondary);">Interactive</span>
                </div>
                <div id="pt-panel">
                    <div><h2 id="p-sym" style="font-size:2.5rem; margin:0; line-height:1;">H</h2><span id="p-cat">Unknown</span></div>
                    <div style="text-align:right;"><h3 id="p-name" style="margin:0;">Hydrogen</h3><p id="p-data" style="margin:0; font-size:0.9rem;">No. 1 | 1.008u</p></div>
                </div>
                <div class="periodic-table" id="table"></div>
            </div>
            <div class="card">
                <h3>Lab Report</h3>
                <textarea id="note-science" class="notes-area" oninput="saveData('science')" placeholder="Draft your lab report here..."></textarea>
            </div>
        </div>

        <div id="ela" class="section">
            <h2>Writing Studio</h2>
            <div class="card">
                <textarea id="note-ela" class="notes-area" oninput="saveData('ela'); countWords('note-ela', 'ela-count')" placeholder="Start your essay..."></textarea>
                <div style="text-align:right; margin-top:8px; font-size:0.85rem; color:var(--text-secondary);" id="ela-count">0 words</div>
            </div>
        </div>

        <div id="history" class="section">
            <h2>History Archives</h2>
            <div class="card">
                <textarea id="note-history" class="notes-area" oninput="saveData('history'); countWords('note-history', 'hist-count')" placeholder="Record historical events..."></textarea>
                <div style="text-align:right; margin-top:8px; font-size:0.85rem; color:var(--text-secondary);" id="hist-count">0 words</div>
            </div>
        </div>

        <div id="fun-home" class="section">
            <h2>Secret Lounge</h2>
            <p style="color:var(--text-secondary);">Welcome to the unlocked zone.</p>
        </div>

        <div id="social-feed" class="section">
            <div class="insta-main-wrapper">
                <div class="insta-navbar">
                    <div class="logo" style="font-family: 'Inter', sans-serif; font-weight:700; font-size:1.2rem;">
                        StudyHall Social
                    </div>
                    <div class="insta-nav-icons">
                        <i class="fas fa-home" onclick="loadPosts()" title="Refresh Feed"></i>
                        <i class="far fa-plus-square" onclick="document.getElementById('new-post-area').style.display = 'block'" title="New Post"></i>
                        <div class="insta-profile-pic" style="width:28px; height:28px; padding:0;">
                            <div id="nav-user-pic" style="width:100%; height:100%; border-radius:50%; background:#333; color:white; display:flex; justify-content:center; align-items:center; font-size:12px;">U</div>
                        </div>
                    </div>
                </div>
                <div id="new-post-area" class="insta-post-card" style="padding:20px; display:none;">
                    <h3 style="margin-bottom:15px;">New Post</h3>
                    <input type="text" id="post-img-url" placeholder="Image URL (optional)..." style="width:100%; margin-bottom:10px; padding:8px; border:1px solid var(--border); border-radius:4px; background:var(--bg-color); color:var(--text-primary);">
                    <textarea id="post-caption-input" placeholder="What's on your mind?" style="width:100%; height:60px; margin-bottom:10px; padding:8px; border:1px solid var(--border); border-radius:4px; background:var(--bg-color); color:var(--text-primary);"></textarea>
                    <div style="display:flex; gap:10px;">
                        <button class="btn btn-primary" onclick="createInstaPost()" style="width:100%;">Share</button>
                        <button class="btn" onclick="document.getElementById('new-post-area').style.display='none'" style="width:100%;">Cancel</button>
                    </div>
                </div>
                <div id="feed-container">
                    <p style="text-align:center; padding:20px; color:var(--text-secondary);">Loading feed...</p>
                </div>
            </div>
        </div>

        <div id="games" class="section">
            <h2>Arcade</h2>
            <div class="dashboard-grid">
                <div class="card" style="text-align:center;"><h3>Geometry Dash</h3><button class="btn btn-primary" style="margin-top:10px; width:100%;" onclick="loadGeoDash()">Play</button></div>
                <div class="card" style="text-align:center;"><h3>Drive Mad</h3><button class="btn btn-primary" style="margin-top:10px; width:100%;" onclick="loadDriveMad()">Play</button></div>
            </div>
            
            <div id="game-container" class="card" style="padding:0; overflow:hidden; margin-top:20px; position:relative;">
                <button class="btn btn-danger" style="position:absolute; top:10px; right:10px; z-index:100; display:none;" id="exit-game-fs" onclick="exitFullGame()">Exit Fullscreen</button>
                <button class="btn btn-primary" style="position:absolute; bottom:10px; right:10px; z-index:100;" onclick="enterFullGame()">‚õ∂ Fullscreen</button>
                <iframe id="game-frame" src="" allow="gamepad *; keyboard-lock *;"></iframe>
            </div>
        </div>

        <div id="chatterbox" class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h2>ChatterBox</h2>
                <button class="btn" onclick="toggleFullscreenEl('chatterbox')">‚õ∂ Fullscreen</button>
            </div>
            <iframe src="https://whatever-works123.github.io/Chatter-Box/" style="height:500px;"></iframe>
        </div>

        <div id="settings" class="section">
            <h2>System Settings</h2>
            <div class="dashboard-grid">
                <div class="card" style="grid-column: span 2;">
                    <h3>üìÖ Edit Class Schedule</h3>
                    <div class="schedule-grid" style="margin-top:15px;">
                        <div class="schedule-col red-day">
                            <h4>üü• Red Day</h4>
                            <input class="class-input" id="set-r1" placeholder="R1 Class">
                            <input class="class-input" id="set-r2" placeholder="R2 Class">
                            <input class="class-input" id="set-r3" placeholder="R3 Class">
                            <input class="class-input" id="set-r4" placeholder="R4 Class">
                        </div>
                        <div class="schedule-col green-day">
                            <h4>üü© Green Day</h4>
                            <input class="class-input" id="set-g5" placeholder="G5 Class">
                            <input class="class-input" id="set-g6" placeholder="G6 Class">
                            <input class="class-input" id="set-g7" placeholder="G7 Class">
                            <input class="class-input" id="set-g8" placeholder="G8 Class">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="saveSettingsSchedule()">Update Schedule</button>
                </div>

                <div class="card">
                    <h3>üîí Stealth Mode</h3>
                    <p style="color:var(--text-secondary); margin-bottom:15px;">Instantly switch between School and Secret modes.</p>
                    <button class="btn btn-primary" onclick="toggleMode()">Switch Mode</button>
                    <p style="font-size:0.8rem; margin-top:10px; color:var(--text-secondary);">Shortcut: Press <strong>ESC</strong> key</p>
                </div>
                <div class="card">
                    <h3>üé® Appearance</h3>
                    <p style="color:var(--text-secondary); margin-bottom:15px;">Switch between Light and Dark interface.</p>
                    <button class="btn" onclick="toggleTheme()">Toggle Theme</button>
                </div>
            </div>
        </div>
    </main>

    <textarea id="drive-mad-code" style="display:none;">
<!DOCTYPE html><html lang="en"><head><base href="https://cdn.jsdelivr.net/gh/genizy/dmad-poki@49b5ab6b987f5f3be58f9dae59c92e8fc1aab9b0/"><script>window.assgdd={"ancestorOrigins":{"0":"https://games.poki.com","1":"https://poki.com"},"href":"https://f9564e4e-ef25-4e4b-ba67-cb11a1576bbd.poki-gdn.com/cc1bc57a-e355-4696-97c2-097bf6188606/index.html?cloudsavegames=y"}</script><meta charset="utf-8"><title>Drive Mad</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link rel="stylesheet" href="webapp/fancade.css"><script src="poki-sdk.js"></script></head><body id="body"><div id="canvas_border" class="emscripten_border"><div id="play_content" class="middle center"><div class="edge"><div class="box"><div class="black"><img src="webapp/cover.jpg" class="cover"><p class="title">Drive Mad</p></div></div></div><div id="progress_or_play"><progress id="progress" class="loading" value="0" max="100"></progress></div></div><canvas class="emscripten" id="canvas" tabindex=-1></canvas></div><script type="text/javascript" src="webapp/source_min.js"></script><script type="text/javascript" src="webapp/index.js"></script></body></html>
    </textarea>
    <textarea id="geo-dash-code" style="display:none;">
<!DOCTYPE html><html lang="en-US"><head><base href="https://rawcdn.githack.com/genizy/google-class/main/gdlite/"><title>Geometry Dash</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="themes/geometrydashlite.io/rs/css/home.css?v=1"></head><body style="margin:0;overflow:hidden;background:#000;"><div id="gameContainer" style="width:100vw;height:100vh;"></div><script src="Build/UnityLoader.js"></script><script>var gameInstance=UnityLoader.instantiate("gameContainer","Build/GeometryDashLite.json");</script></body></html>
    </textarea>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyABujQAAYKhMxJddtJSvTShWEZ8bqF3kzA", authDomain: "chatterbox3000-fb3e2.firebaseapp.com", databaseURL: "https://chatterbox3000-fb3e2-default-rtdb.firebaseio.com", projectId: "chatterbox3000-fb3e2", storageBucket: "chatterbox3000-fb3e2.firebasestorage.app", messagingSenderId: "298622361038", appId: "1:298622361038:web:c1e46432470dbce92a5f9f" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let currentUser = null;
        let todoArray = [];

        const hour = new Date().getHours();
        document.getElementById('greeting').innerText = hour < 12 ? 'Good Morning.' : hour < 18 ? 'Good Afternoon.' : 'Good Evening.';

        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('user-display').innerText = user.email.split('@')[0];
                loadUserData();
                loadPosts(); 
                
                // CHECK IF SCHEDULE IS SET
                db.ref('users/' + user.uid + '/schedule').once('value').then(snap => {
                    if(!snap.exists()) {
                        document.getElementById('setup-overlay').style.display = 'flex';
                    } else {
                        renderSchedule(snap.val());
                        fillSettingsInputs(snap.val());
                    }
                });

            } else {
                document.getElementById('login-overlay').style.display = 'flex';
                currentUser = null;
            }
        });

        function loginUser() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const err = document.getElementById('login-error');
            err.innerText = "Authenticating...";
            auth.signInWithEmailAndPassword(email, pass).catch(e => err.innerText = e.message);
        }
        function logoutUser() { auth.signOut(); location.reload(); }
        function toast(msg) { const t = document.getElementById('toast'); t.innerText = msg || "Saved automatically"; t.style.opacity = '1'; setTimeout(() => t.style.opacity = '0', 2000); }

        function loadUserData() {
            if(!currentUser) return;
            db.ref('users/' + currentUser.uid).once('value').then(snap => {
                const data = snap.val();
                if (data) {
                    ['math', 'science', 'ela', 'history'].forEach(sub => {
                        if(data[sub]) {
                            document.getElementById('note-' + sub).value = data[sub];
                            if(sub === 'ela' || sub === 'history') countWords('note-'+sub, sub==='ela'?'ela-count':'hist-count');
                        }
                    });
                    if(data.todos) { todoArray = data.todos; renderTodos(); }
                }
            });
        }
        function saveData(subject) { if(!currentUser) return; db.ref('users/' + currentUser.uid + '/' + subject).set(document.getElementById('note-' + subject).value).then(() => toast()); }

        // --- SCHEDULE LOGIC ---
        function saveInitialSetup() {
            const schedule = {
                r1: document.getElementById('setup-r1').value,
                r2: document.getElementById('setup-r2').value,
                r3: document.getElementById('setup-r3').value,
                r4: document.getElementById('setup-r4').value,
                g5: document.getElementById('setup-g5').value,
                g6: document.getElementById('setup-g6').value,
                g7: document.getElementById('setup-g7').value,
                g8: document.getElementById('setup-g8').value
            };
            db.ref('users/' + currentUser.uid + '/schedule').set(schedule).then(() => {
                document.getElementById('setup-overlay').style.display = 'none';
                renderSchedule(schedule);
                fillSettingsInputs(schedule);
                toast("Schedule Saved!");
            });
        }

        function saveSettingsSchedule() {
            const schedule = {
                r1: document.getElementById('set-r1').value,
                r2: document.getElementById('set-r2').value,
                r3: document.getElementById('set-r3').value,
                r4: document.getElementById('set-r4').value,
                g5: document.getElementById('set-g5').value,
                g6: document.getElementById('set-g6').value,
                g7: document.getElementById('set-g7').value,
                g8: document.getElementById('set-g8').value
            };
            db.ref('users/' + currentUser.uid + '/schedule').set(schedule).then(() => {
                renderSchedule(schedule);
                toast("Schedule Updated!");
            });
        }

        function renderSchedule(s) {
            document.getElementById('dash-red-list').innerHTML = `
                <li><span>R1</span> ${s.r1 || 'Free Period'}</li>
                <li><span>R2</span> ${s.r2 || 'Free Period'}</li>
                <li><span>R3</span> ${s.r3 || 'Free Period'}</li>
                <li><span>R4</span> ${s.r4 || 'Free Period'}</li>
            `;
            document.getElementById('dash-green-list').innerHTML = `
                <li><span>G5</span> ${s.g5 || 'Free Period'}</li>
                <li><span>G6</span> ${s.g6 || 'Free Period'}</li>
                <li><span>G7</span> ${s.g7 || 'Free Period'}</li>
                <li><span>G8</span> ${s.g8 || 'Free Period'}</li>
            `;
        }

        function fillSettingsInputs(s) {
            document.getElementById('set-r1').value = s.r1 || '';
            document.getElementById('set-r2').value = s.r2 || '';
            document.getElementById('set-r3').value = s.r3 || '';
            document.getElementById('set-r4').value = s.r4 || '';
            document.getElementById('set-g5').value = s.g5 || '';
            document.getElementById('set-g6').value = s.g6 || '';
            document.getElementById('set-g7').value = s.g7 || '';
            document.getElementById('set-g8').value = s.g8 || '';
        }

        // --- TODO LOGIC ---
        function addTodo() { const txt = document.getElementById('newTodo').value; if(!txt) return; todoArray.push({text: txt, done: false}); updateTodoDB(); document.getElementById('newTodo').value = ''; }
        function toggleTodo(idx) { todoArray[idx].done = !todoArray[idx].done; updateTodoDB(); }
        function removeTodo(idx) { todoArray.splice(idx, 1); updateTodoDB(); }
        function updateTodoDB() { if(currentUser) db.ref('users/' + currentUser.uid + '/todos').set(todoArray).then(() => toast("Task updated")); renderTodos(); }
        function renderTodos() {
            const list = document.getElementById('todoList');
            const mini = document.getElementById('mini-todo-list');
            list.innerHTML = ''; mini.innerHTML = '';
            let pendingCount = 0;
            todoArray.forEach((task, i) => {
                list.innerHTML += `<div class="todo-item ${task.done ? 'done' : ''}"><span onclick="toggleTodo(${i})" style="cursor:pointer; flex:1;">${task.text}</span><button class="btn btn-danger" onclick="removeTodo(${i})" style="padding:4px 8px; font-size:0.8rem;">√ó</button></div>`;
                if(!task.done) { pendingCount++; if(pendingCount <= 3) mini.innerHTML += `<li style="margin-bottom:5px;">‚Ä¢ ${task.text}</li>`; }
            });
            if(pendingCount === 0) mini.innerHTML = '<li style="color:var(--text-secondary);">No pending tasks.</li>';
        }

        function calc(val) {
            const disp = document.getElementById('calcDisplay');
            if(val === 'C') disp.value = '';
            else if(val === '=') { try { let expr = disp.value.replace(/sin/g, 'Math.sin').replace(/cos/g, 'Math.cos').replace(/tan/g, 'Math.tan').replace(/sqrt/g, 'Math.sqrt').replace(/pow/g, 'Math.pow').replace(/PI/g, 'Math.PI'); disp.value = eval(expr); } catch { disp.value = 'Error'; } } 
            else { disp.value += val; }
        }

        let timerInt = null; let timeLeft = 25 * 60;
        function toggleTimer() {
            const ui = document.getElementById('timer-ui');
            if(timerInt) { clearInterval(timerInt); timerInt = null; ui.classList.remove('timer-active'); }
            else { ui.classList.add('timer-active'); timerInt = setInterval(() => { if(timeLeft > 0) { timeLeft--; let m = Math.floor(timeLeft / 60).toString().padStart(2, '0'); let s = (timeLeft % 60).toString().padStart(2, '0'); document.getElementById('timer-display').innerText = `${m}:${s}`; } else { clearInterval(timerInt); ui.classList.remove('timer-active'); alert("Time's up!"); } }, 1000); }
        }
        function resetTimer() { clearInterval(timerInt); timerInt = null; document.getElementById('timer-ui').classList.remove('timer-active'); timeLeft = 25 * 60; document.getElementById('timer-display').innerText = "25:00"; }
        function countWords(areaId, displayId) { const txt = document.getElementById(areaId).value.trim(); const count = txt ? txt.split(/\s+/).length : 0; document.getElementById(displayId).innerText = count + " words"; }

        // --- REAL-TIME INSTA LOGIC ---

        function createInstaPost() {
            if(!currentUser) return alert("Please login first.");
            
            const caption = document.getElementById('post-caption-input').value;
            const imgUrl = document.getElementById('post-img-url').value;
            
            if(!caption && !imgUrl) return alert("Please write a caption or add an image.");

            const newPost = {
                username: currentUser.email.split('@')[0],
                image: imgUrl || '', // Optional Image
                caption: caption,
                likes: 0,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            };

            db.ref('posts').push(newPost).then(() => {
                toast("Shared to Feed!");
                document.getElementById('post-caption-input').value = '';
                document.getElementById('post-img-url').value = '';
                document.getElementById('new-post-area').style.display = 'none';
            });
        }

        function loadPosts() {
            const feed = document.getElementById('feed-container');
            
            // Update nav avatar
            if(currentUser) {
                document.getElementById('nav-user-pic').innerText = currentUser.email.charAt(0).toUpperCase();
            }

            db.ref('posts').limitToLast(20).on('value', snapshot => {
                feed.innerHTML = '';
                const posts = [];
                snapshot.forEach(child => {
                    posts.push({ id: child.key, ...child.val() });
                });

                if(posts.length === 0) {
                    feed.innerHTML = '<div style="text-align:center; padding:40px; color:var(--text-secondary);">No posts yet.<br>Be the first to share something!</div>';
                    return;
                }
                
                // Show newest first
                posts.reverse().forEach(post => {
                    const hasImage = post.image && post.image.trim() !== '';
                    const userInitial = post.username.charAt(0).toUpperCase();
                    
                    // CHECK IF LIKED BY CURRENT USER
                    const likedBy = post.likedBy || {};
                    const isLiked = currentUser && likedBy[currentUser.uid];
                    const heartClass = isLiked ? "fas fa-heart liked" : "far fa-heart";

                    const card = document.createElement('div');
                    card.className = 'insta-post-card';
                    
                    let imageHTML = '';
                    if(hasImage) {
                        imageHTML = `<img class="insta-post-img" src="${post.image}" onerror="this.style.display='none'">`;
                    }

                    card.innerHTML = `
                        <div class="insta-post-header">
                            <div class="insta-user-details">
                                <div class="insta-profile-pic">
                                    <div style="display:flex; align-items:center; justify-content:center; font-weight:700; color:#333; background:#eee; width:100%; height:100%; border-radius:50%;">${userInitial}</div>
                                </div>
                                <div>
                                    <h3>${post.username}</h3>
                                    <span>StudyHall Student</span>
                                </div>
                            </div>
                            <i class="fas fa-ellipsis-h insta-post-menu"></i>
                        </div>
                        ${imageHTML}
                        <div class="insta-post-footer">
                            <div class="insta-actions">
                                <div class="insta-action-left">
                                    <i class="${heartClass}" onclick="likePost('${post.id}')"></i>
                                    <i class="far fa-comment"></i>
                                    <i class="far fa-paper-plane"></i>
                                </div>
                                <i class="far fa-bookmark"></i>
                            </div>
                            <p class="insta-likes">${post.likes || 0} likes</p>
                            <div class="insta-caption">
                                <b>${post.username}</b> ${post.caption || ''}
                            </div>
                            <p class="insta-time">Recently</p>
                        </div>
                    `;
                    feed.appendChild(card);
                });
            });
        }

        // UPDATED LIKE FUNCTION
        function likePost(postId) {
            if(!currentUser) return alert("Please login to like posts.");
            
            const uid = currentUser.uid;
            
            // Check if user already liked
            db.ref('posts/' + postId + '/likedBy/' + uid).once('value', snapshot => {
                if (snapshot.exists()) {
                    // ALREADY LIKED -> UNLIKE
                    db.ref('posts/' + postId + '/likedBy/' + uid).remove();
                    db.ref('posts/' + postId + '/likes').transaction(current => (current || 0) - 1);
                } else {
                    // NOT LIKED -> LIKE
                    db.ref('posts/' + postId + '/likedBy/' + uid).set(true);
                    db.ref('posts/' + postId + '/likes').transaction(current => (current || 0) + 1);
                }
            });
        }

        // --- PERIODIC TABLE ---
        const ptElements = [ { num: 1, sym: "H", name: "Hydrogen", mass: "1.008", cat: "reactive-nonmetal", col: 1, row: 1 }, { num: 2, sym: "He", name: "Helium", mass: "4.0026", cat: "noble-gas", col: 18, row: 1 }, { num: 3, sym: "Li", name: "Lithium", mass: "6.94", cat: "alkali", col: 1, row: 2 }, { num: 4, sym: "Be", name: "Beryllium", mass: "9.0122", cat: "alkaline", col: 2, row: 2 }, { num: 5, sym: "B", name: "Boron", mass: "10.81", cat: "metalloid", col: 13, row: 2 }, { num: 6, sym: "C", name: "Carbon", mass: "12.011", cat: "reactive-nonmetal", col: 14, row: 2 }, { num: 7, sym: "N", name: "Nitrogen", mass: "14.007", cat: "reactive-nonmetal", col: 15, row: 2 }, { num: 8, sym: "O", name: "Oxygen", mass: "15.999", cat: "reactive-nonmetal", col: 16, row: 2 }, { num: 9, sym: "F", name: "Fluorine", mass: "18.998", cat: "reactive-nonmetal", col: 17, row: 2 }, { num: 10, sym: "Ne", name: "Neon", mass: "20.180", cat: "noble-gas", col: 18, row: 2 }, { num: 11, sym: "Na", name: "Sodium", mass: "22.990", cat: "alkali", col: 1, row: 3 }, { num: 12, sym: "Mg", name: "Magnesium", mass: "24.305", cat: "alkaline", col: 2, row: 3 }, { num: 13, sym: "Al", name: "Aluminum", mass: "26.982", cat: "post-transition", col: 13, row: 3 }, { num: 14, sym: "Si", name: "Silicon", mass: "28.085", cat: "metalloid", col: 14, row: 3 }, { num: 15, sym: "P", name: "Phosphorus", mass: "30.974", cat: "reactive-nonmetal", col: 15, row: 3 }, { num: 16, sym: "S", name: "Sulfur", mass: "32.06", cat: "reactive-nonmetal", col: 16, row: 3 }, { num: 17, sym: "Cl", name: "Chlorine", mass: "35.45", cat: "reactive-nonmetal", col: 17, row: 3 }, { num: 18, sym: "Ar", name: "Argon", mass: "39.948", cat: "noble-gas", col: 18, row: 3 }, { num: 19, sym: "K", name: "Potassium", mass: "39.098", cat: "alkali", col: 1, row: 4 }, { num: 20, sym: "Ca", name: "Calcium", mass: "40.078", cat: "alkaline", col: 2, row: 4 }, { num: 21, sym: "Sc", name: "Scandium", mass: "44.956", cat: "transition", col: 3, row: 4 }, { num: 22, sym: "Ti", name: "Titanium", mass: "47.867", cat: "transition", col: 4, row: 4 }, { num: 23, sym: "V", name: "Vanadium", mass: "50.942", cat: "transition", col: 5, row: 4 }, { num: 24, sym: "Cr", name: "Chromium", mass: "51.996", cat: "transition", col: 6, row: 4 }, { num: 25, sym: "Mn", name: "Manganese", mass: "54.938", cat: "transition", col: 7, row: 4 }, { num: 26, sym: "Fe", name: "Iron", mass: "55.845", cat: "transition", col: 8, row: 4 }, { num: 27, sym: "Co", name: "Cobalt", mass: "58.933", cat: "transition", col: 9, row: 4 }, { num: 28, sym: "Ni", name: "Nickel", mass: "58.693", cat: "transition", col: 10, row: 4 }, { num: 29, sym: "Cu", name: "Copper", mass: "63.546", cat: "transition", col: 11, row: 4 }, { num: 30, sym: "Zn", name: "Zinc", mass: "65.38", cat: "transition", col: 12, row: 4 }, { num: 31, sym: "Ga", name: "Gallium", mass: "69.723", cat: "post-transition", col: 13, row: 4 }, { num: 32, sym: "Ge", name: "Germanium", mass: "72.630", cat: "metalloid", col: 14, row: 4 }, { num: 33, sym: "As", name: "Arsenic", mass: "74.922", cat: "metalloid", col: 15, row: 4 }, { num: 34, sym: "Se", name: "Selenium", mass: "78.971", cat: "reactive-nonmetal", col: 16, row: 4 }, { num: 35, sym: "Br", name: "Bromine", mass: "79.904", cat: "reactive-nonmetal", col: 17, row: 4 }, { num: 36, sym: "Kr", name: "Krypton", mass: "83.798", cat: "noble-gas", col: 18, row: 4 }, { num: 37, sym: "Rb", name: "Rubidium", mass: "85.468", cat: "alkali", col: 1, row: 5 }, { num: 38, sym: "Sr", name: "Strontium", mass: "87.62", cat: "alkaline", col: 2, row: 5 }, { num: 39, sym: "Y", name: "Yttrium", mass: "88.906", cat: "transition", col: 3, row: 5 }, { num: 40, sym: "Zr", name: "Zirconium", mass: "91.224", cat: "transition", col: 4, row: 5 }, { num: 41, sym: "Nb", name: "Niobium", mass: "92.906", cat: "transition", col: 5, row: 5 }, { num: 42, sym: "Mo", name: "Molybdenum", mass: "95.95", cat: "transition", col: 6, row: 5 }, { num: 43, sym: "Tc", name: "Technetium", mass: "98", cat: "transition", col: 7, row: 5 }, { num: 44, sym: "Ru", name: "Ruthenium", mass: "101.07", cat: "transition", col: 8, row: 5 }, { num: 45, sym: "Rh", name: "Rhodium", mass: "102.91", cat: "transition", col: 9, row: 5 }, { num: 46, sym: "Pd", name: "Palladium", mass: "106.42", cat: "transition", col: 10, row: 5 }, { num: 47, sym: "Ag", name: "Silver", mass: "107.87", cat: "transition", col: 11, row: 5 }, { num: 48, sym: "Cd", name: "Cadmium", mass: "112.41", cat: "transition", col: 12, row: 5 }, { num: 49, sym: "In", name: "Indium", mass: "114.82", cat: "post-transition", col: 13, row: 5 }, { num: 50, sym: "Sn", name: "Tin", mass: "118.71", cat: "post-transition", col: 14, row: 5 }, { num: 51, sym: "Sb", name: "Antimony", mass: "121.76", cat: "metalloid", col: 15, row: 5 }, { num: 52, sym: "Te", name: "Tellurium", mass: "127.60", cat: "metalloid", col: 16, row: 5 }, { num: 53, sym: "I", name: "Iodine", mass: "126.90", cat: "reactive-nonmetal", col: 17, row: 5 }, { num: 54, sym: "Xe", name: "Xenon", mass: "131.29", cat: "noble-gas", col: 18, row: 5 }, { num: 55, sym: "Cs", name: "Cesium", mass: "132.91", cat: "alkali", col: 1, row: 6 }, { num: 56, sym: "Ba", name: "Barium", mass: "137.33", cat: "alkaline", col: 2, row: 6 }, { num: 57, sym: "La", name: "Lanthanum", mass: "138.91", cat: "lanthanide", col: 4, row: 9 }, { num: 58, sym: "Ce", name: "Cerium", mass: "140.12", cat: "lanthanide", col: 5, row: 9 }, { num: 59, sym: "Pr", name: "Praseodymium", mass: "140.91", cat: "lanthanide", col: 6, row: 9 }, { num: 60, sym: "Nd", name: "Neodymium", mass: "144.24", cat: "lanthanide", col: 7, row: 9 }, { num: 61, sym: "Pm", name: "Promethium", mass: "145", cat: "lanthanide", col: 8, row: 9 }, { num: 62, sym: "Sm", name: "Samarium", mass: "150.36", cat: "lanthanide", col: 9, row: 9 }, { num: 63, sym: "Eu", name: "Europium", mass: "151.96", cat: "lanthanide", col: 10, row: 9 }, { num: 64, sym: "Gd", name: "Gadolinium", mass: "157.25", cat: "lanthanide", col: 11, row: 9 }, { num: 65, sym: "Tb", name: "Terbium", mass: "158.93", cat: "lanthanide", col: 12, row: 9 }, { num: 66, sym: "Dy", name: "Dysprosium", mass: "162.50", cat: "lanthanide", col: 13, row: 9 }, { num: 67, sym: "Ho", name: "Holmium", mass: "164.93", cat: "lanthanide", col: 14, row: 9 }, { num: 68, sym: "Er", name: "Erbium", mass: "167.26", cat: "lanthanide", col: 15, row: 9 }, { num: 69, sym: "Tm", name: "Thulium", mass: "168.93", cat: "lanthanide", col: 16, row: 9 }, { num: 70, sym: "Yb", name: "Ytterbium", mass: "173.05", cat: "lanthanide", col: 17, row: 9 }, { num: 71, sym: "Lu", name: "Lutetium", mass: "174.97", cat: "lanthanide", col: 18, row: 9 }, { num: 72, sym: "Hf", name: "Hafnium", mass: "178.49", cat: "transition", col: 4, row: 6 }, { num: 73, sym: "Ta", name: "Tantalum", mass: "180.95", cat: "transition", col: 5, row: 6 }, { num: 74, sym: "W", name: "Tungsten", mass: "183.84", cat: "transition", col: 6, row: 6 }, { num: 75, sym: "Re", name: "Rhenium", mass: "186.21", cat: "transition", col: 7, row: 6 }, { num: 76, sym: "Os", name: "Osmium", mass: "190.23", cat: "transition", col: 8, row: 6 }, { num: 77, sym: "Ir", name: "Iridium", mass: "192.22", cat: "transition", col: 9, row: 6 }, { num: 78, sym: "Pt", name: "Platinum", mass: "195.08", cat: "transition", col: 10, row: 6 }, { num: 79, sym: "Au", name: "Gold", mass: "196.97", cat: "transition", col: 11, row: 6 }, { num: 80, sym: "Hg", name: "Mercury", mass: "200.59", cat: "transition", col: 12, row: 6 }, { num: 81, sym: "Tl", name: "Thallium", mass: "204.38", cat: "post-transition", col: 13, row: 6 }, { num: 82, sym: "Pb", name: "Lead", mass: "207.2", cat: "post-transition", col: 14, row: 6 }, { num: 83, sym: "Bi", name: "Bismuth", mass: "208.98", cat: "post-transition", col: 15, row: 6 }, { num: 84, sym: "Po", name: "Polonium", mass: "209", cat: "post-transition", col: 16, row: 6 }, { num: 85, sym: "At", name: "Astatine", mass: "210", cat: "metalloid", col: 17, row: 6 }, { num: 86, sym: "Rn", name: "Radon", mass: "222", cat: "noble-gas", col: 18, row: 6 }, { num: 87, sym: "Fr", name: "Francium", mass: "223", cat: "alkali", col: 1, row: 7 }, { num: 88, sym: "Ra", name: "Radium", mass: "226", cat: "alkaline", col: 2, row: 7 }, { num: 89, sym: "Ac", name: "Actinium", mass: "227", cat: "actinide", col: 4, row: 10 }, { num: 90, sym: "Th", name: "Thorium", mass: "232.04", cat: "actinide", col: 5, row: 10 }, { num: 91, sym: "Pa", name: "Protactinium", mass: "231.04", cat: "actinide", col: 6, row: 10 }, { num: 92, sym: "U", name: "Uranium", mass: "238.03", cat: "actinide", col: 7, row: 10 }, { num: 93, sym: "Np", name: "Neptunium", mass: "237", cat: "actinide", col: 8, row: 10 }, { num: 94, sym: "Pu", name: "Plutonium", mass: "244", cat: "actinide", col: 9, row: 10 }, { num: 95, sym: "Am", name: "Americium", mass: "243", cat: "actinide", col: 10, row: 10 }, { num: 96, sym: "Cm", name: "Curium", mass: "247", cat: "actinide", col: 11, row: 10 }, { num: 97, sym: "Bk", name: "Berkelium", mass: "247", cat: "actinide", col: 12, row: 10 }, { num: 98, sym: "Cf", name: "Californium", mass: "251", cat: "actinide", col: 13, row: 10 }, { num: 99, sym: "Es", name: "Einsteinium", mass: "252", cat: "actinide", col: 14, row: 10 }, { num: 100, sym: "Fm", name: "Fermium", mass: "257", cat: "actinide", col: 15, row: 10 }, { num: 101, sym: "Md", name: "Mendelevium", mass: "258", cat: "actinide", col: 16, row: 10 }, { num: 102, sym: "No", name: "Nobelium", mass: "259", cat: "actinide", col: 17, row: 10 }, { num: 103, sym: "Lr", name: "Lawrencium", mass: "266", cat: "actinide", col: 18, row: 10 }, { num: 104, sym: "Rf", name: "Rutherfordium", mass: "267", cat: "transition", col: 4, row: 7 }, { num: 105, sym: "Db", name: "Dubnium", mass: "268", cat: "transition", col: 5, row: 7 }, { num: 106, sym: "Sg", name: "Seaborgium", mass: "269", cat: "transition", col: 6, row: 7 }, { num: 107, sym: "Bh", name: "Bohrium", mass: "270", cat: "transition", col: 7, row: 7 }, { num: 108, sym: "Hs", name: "Hassium", mass: "277", cat: "transition", col: 8, row: 7 }, { num: 109, sym: "Mt", name: "Meitnerium", mass: "278", cat: "unknown", col: 9, row: 7 }, { num: 110, sym: "Ds", name: "Darmstadtium", mass: "281", cat: "unknown", col: 10, row: 7 }, { num: 111, sym: "Rg", name: "Roentgenium", mass: "282", cat: "unknown", col: 11, row: 7 }, { num: 112, sym: "Cn", name: "Copernicium", mass: "285", cat: "transition", col: 12, row: 7 }, { num: 113, sym: "Nh", name: "Nihonium", mass: "286", cat: "unknown", col: 13, row: 7 }, { num: 114, sym: "Fl", name: "Flerovium", mass: "289", cat: "unknown", col: 14, row: 7 }, { num: 115, sym: "Mc", name: "Moscovium", mass: "290", cat: "unknown", col: 15, row: 7 }, { num: 116, sym: "Lv", name: "Livermorium", mass: "293", cat: "unknown", col: 16, row: 7 }, { num: 117, sym: "Ts", name: "Tennessine", mass: "294", cat: "unknown", col: 17, row: 7 }, { num: 118, sym: "Og", name: "Oganesson", mass: "294", cat: "unknown", col: 18, row: 7 } ];
        function renderPT() {
            const table = document.getElementById('table'); const panel = document.getElementById('pt-panel');
            ptElements.forEach(el => {
                const div = document.createElement('div'); let c = 'cat-unknown'; if(el.cat==='alkali') c='cat-alkali'; if(el.cat==='alkaline') c='cat-alkaline'; if(el.cat==='transition') c='cat-transition'; if(el.cat==='post-transition') c='cat-post-transition'; if(el.cat==='metalloid') c='cat-metalloid'; if(el.cat==='reactive-nonmetal') c='cat-reactive-nonmetal'; if(el.cat==='noble-gas') c='cat-noble-gas'; if(el.cat==='lanthanide') c='cat-lanthanide'; if(el.cat==='actinide') c='cat-actinide'; div.className = `element ${c}`; div.style.gridColumn = el.col; div.style.gridRow = el.row; div.innerHTML = `<div class="num">${el.num}</div><div class="sym">${el.sym}</div>`;
                div.addEventListener('click', () => { panel.classList.add('active'); document.getElementById('p-sym').innerText = el.sym; document.getElementById('p-name').innerText = el.name; document.getElementById('p-data').innerText = `No. ${el.num} | ${el.mass}u`; document.getElementById('p-cat').innerText = el.cat.replace(/-/g, ' '); document.getElementById('p-sym').style.color = getComputedStyle(div).borderBottomColor; }); table.appendChild(div);
            });
        }
        renderPT();

        function showSection(id) { document.querySelectorAll('.section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active')); const btn = Array.from(document.querySelectorAll('.nav-btn')).find(b => b.getAttribute('onclick').includes(id)); if(btn) btn.classList.add('active'); }
        function toggleMode() { document.body.classList.toggle('mode-school'); document.body.classList.toggle('mode-fun'); showSection(document.body.classList.contains('mode-school') ? 'school-home' : 'fun-home'); }
        function toggleTheme() { const b = document.body; b.setAttribute('data-theme', b.getAttribute('data-theme') === 'light' ? 'dark' : 'light'); }
        function loadGame(codeId) { const iframe = document.getElementById('game-frame'); iframe.srcdoc = document.getElementById(codeId).value; iframe.onload = () => { iframe.contentWindow.focus(); const container = document.getElementById('game-container'); if(container.classList.contains('fullscreen-mode')) document.getElementById('exit-game-fs').style.display = 'block'; }; }
        function loadDriveMad() { loadGame('drive-mad-code'); } function loadGeoDash() { loadGame('geo-dash-code'); }
        function toggleFullscreenEl(id) { const el = document.getElementById(id); if(el.classList.contains('fullscreen-mode')) { el.classList.remove('fullscreen-mode'); } else { document.querySelectorAll('.fullscreen-mode').forEach(e => e.classList.remove('fullscreen-mode')); el.classList.add('fullscreen-mode'); } }
        function enterFullGame() { document.getElementById('game-container').classList.add('fullscreen-mode'); document.getElementById('exit-game-fs').style.display = 'block'; }
        function exitFullGame() { document.getElementById('game-container').classList.remove('fullscreen-mode'); document.getElementById('exit-game-fs').style.display = 'none'; }
        document.addEventListener('keydown', e => { if(e.key === "Escape") { const fs = document.querySelector('.fullscreen-mode'); if(fs) { fs.classList.remove('fullscreen-mode'); if(fs.id === 'game-container') document.getElementById('exit-game-fs').style.display = 'none'; } else if(document.body.classList.contains('mode-fun')) { toggleMode(); } } });
    </script>
</body>
</html>
